name: Test Build (Fast)

# Workflow rapide pour tester sans crÃ©er le .exe complet
on:
  pull_request:
    branches:
      - main
      - master
  workflow_dispatch:

jobs:
  test:
    runs-on: windows-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: ğŸ“¦ Install Backend deps
        run: |
          cd backend
          python -m venv venv
          .\venv\Scripts\activate
          pip install -r requirements.txt
        shell: cmd

      - name: ğŸ“¦ Install Frontend deps
        run: |
          cd frontend
          npm install -g yarn
          yarn install
        shell: cmd

      - name: ğŸ§ª Test Backend
        run: |
          cd backend
          .\venv\Scripts\activate
          python -c "import fastapi; print('âœ“ FastAPI OK')"
          python -c "import motor; print('âœ“ Motor OK')"
          python -c "import reportlab; print('âœ“ ReportLab OK')"
        shell: cmd

      - name: ğŸ§ª Test Frontend Build
        run: |
          cd frontend
          yarn build
        shell: cmd
        env:
          CI: false

      - name: âœ… Tests Passed
        run: |
          echo "========================================"
          echo "    TOUS LES TESTS SONT PASSÃ‰S !"
          echo "========================================"
        shell: cmd
